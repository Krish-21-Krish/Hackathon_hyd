<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin - Student Management</title>

<style>
* { margin: 0; padding: 0; box-sizing: border-box; }

/* BODY */
body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #ffffff;
    min-height: 100vh;
    padding: 20px;
}

/* LIGHTNING SVG */
#lightning-layer {
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 0;
}

#lightning {
    fill: none;
    stroke: #38ef7d;
    stroke-width: 2.5;
    stroke-linecap: round;
    stroke-linejoin: round;
    filter: drop-shadow(0 0 10px rgba(56,239,125,0.9));
    opacity: 0;
}

/* CONTAINER */
.container {
    position: relative;
    z-index: 1;
    max-width: 1200px;
    margin: 0 auto;
    background: #f4fdf9;
    padding: 30px;
    border-radius: 14px;
    box-shadow: 0 10px 40px rgba(0,0,0,0.15);
}

h1 { color: #11998e; font-size: 32px; margin-bottom: 10px; }
.subtitle { color: #666; margin-bottom: 30px; font-size: 14px; }

/* TABS */
.tabs {
    display: flex;
    gap: 10px;
    margin-bottom: 30px;
    border-bottom: 2px solid #dff3ec;
}

.tab {
    padding: 12px 24px;
    background: none;
    border: none;
    cursor: pointer;
    font-size: 16px;
    color: #666;
    border-bottom: 3px solid transparent;
}

.tab.active {
    color: #11998e;
    border-bottom-color: #11998e;
    font-weight: 600;
}

.tab-content { display: none; }
.tab-content.active { display: block; }

/* SECTIONS */
.section {
    background: white;
    padding: 25px;
    border-radius: 10px;
    margin-bottom: 20px;
    border-left: 4px solid #11998e;
}

label { font-weight: 600; margin-bottom: 8px; display: block; }

input, select {
    width: 100%;
    padding: 12px;
    border: 2px solid #dff3ec;
    border-radius: 6px;
}

input:focus, select:focus {
    outline: none;
    border-color: #11998e;
}

/* BUTTONS */
button {
    background: linear-gradient(135deg, #11998e, #38ef7d);
    color: white;
    border: none;
    padding: 12px 28px;
    border-radius: 6px;
    cursor: pointer;
    font-weight: 600;
}

.btn-secondary { background: #6c757d; }

/* RESULT */
.result { margin-top: 20px; padding: 15px; border-radius: 6px; }
.success { background: #d4edda; color: #155724; }
.error { background: #f8d7da; color: #721c24; }

/* TABLE */
.students-table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
}

.students-table th {
    background: #11998e;
    color: white;
    padding: 15px;
}

.students-table td {
    padding: 12px 15px;
    border-bottom: 1px solid #e0e0e0;
}

/* STATS */
.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
}

.stat-card {
    background: white;
    padding: 20px;
    border-radius: 8px;
    border-left: 4px solid #11998e;
}

.stat-number {
    font-size: 32px;
    font-weight: 700;
    color: #11998e;
}
</style>
</head>

<body>

<!-- LIGHTNING -->
<svg id="lightning-layer">
    <polyline id="lightning"></polyline>
</svg>

<div class="container">

<h1>üéì Admin Panel - Student Management</h1>
<p class="subtitle">Manage classes, students, and bulk imports</p>

<div class="tabs">
    <button class="tab active" onclick="switchTab('classes', event)">üìö Manage Classes</button>
    <button class="tab" onclick="switchTab('students', event)">üë®‚Äçüéì Add Students</button>
    <button class="tab" onclick="switchTab('bulk', event)">üì§ Bulk Upload</button>
    <button class="tab" onclick="switchTab('view', event)">üìã View Students</button>
</div>

<!-- TAB 1 -->
<div id="classes" class="tab-content active">
    <div class="section">
        <label>Class ID</label>
        <input id="class_id">
        <label>Class Name</label>
        <input id="class_name">
        <label>Department</label>
        <input id="department">
        <button onclick="addClass()">Add Class</button>
        <div id="class_result"></div>
    </div>
    <div class="section">
        <button class="btn-secondary" onclick="loadClasses()">Refresh</button>
        <div id="classes_list"></div>
    </div>
</div>

<!-- TAB 2 -->
<div id="students" class="tab-content">
    <div class="section">
        <input id="reg_no" placeholder="Reg No">
        <input id="student_name" placeholder="Student Name">
        <select id="student_class_id"></select>
        <button onclick="addStudent()">Add Student</button>
        <div id="student_result"></div>
    </div>
</div>

<!-- TAB 3 -->
<div id="bulk" class="tab-content">
    <div class="section">
        <input type="file" id="csv_file" onchange="handleFileSelect()">
        <p id="file_name"></p>
        <button onclick="uploadCSV()">Upload CSV</button>
        <div id="bulk_result"></div>
        <button class="btn-secondary" onclick="downloadSample()">Download Sample</button>
    </div>
</div>

<!-- TAB 4 -->
<div id="view" class="tab-content">
    <div class="stats-grid">
        <div class="stat-card"><div id="total_students" class="stat-number">0</div></div>
        <div class="stat-card"><div id="total_classes" class="stat-number">0</div></div>
    </div>
    <div class="section">
        <select id="filter_class_id" onchange="loadStudents()"></select>
        <button class="btn-secondary" onclick="loadStudents()">Refresh</button>
        <div id="students_table"></div>
    </div>
</div>

</div>

<!-- ORIGINAL SCRIPT (UNCHANGED LOGIC) -->
<script>
const API_URL = 'http://localhost:5000/api';

function switchTab(tabName, event) {
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    document.querySelectorAll('.tab-content').forEach(tc => tc.classList.remove('active'));
    event.target.classList.add('active');
    document.getElementById(tabName).classList.add('active');
    if (tabName === 'view') { loadStudents(); loadStats(); }
    if (tabName === 'students' || tabName === 'view') loadClassesDropdown();
    if (tabName === 'classes') loadClasses();
}

async function addClass() {
    const data = {
        class_id: parseInt(class_id.value),
        class_name: class_name.value,
        department: department.value
    };
    const r = await fetch(`${API_URL}/classes`, {
        method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify(data)
    });
    class_result.innerHTML = `<div class="success">Done</div>`;
    loadClasses();
}

async function loadClasses() {
    const r = await fetch(`${API_URL}/classes`);
    const d = await r.json();
    classes_list.innerHTML = `<table class="students-table">${d.map(c=>`<tr><td>${c.class_id}</td><td>${c.class_name}</td><td>${c.department}</td></tr>`).join('')}</table>`;
}

async function loadClassesDropdown() {
    const r = await fetch(`${API_URL}/classes`);
    const d = await r.json();
    [student_class_id, filter_class_id].forEach(s=>{
        s.innerHTML = '<option value="">Select</option>';
        d.forEach(c=>s.innerHTML+=`<option value="${c.class_id}">${c.class_name}</option>`);
    });
}

async function addStudent() {
    await fetch(`${API_URL}/students`, {
        method:'POST', headers:{'Content-Type':'application/json'},
        body:JSON.stringify({reg_no:reg_no.value, student_name:student_name.value, class_id:+student_class_id.value})
    });
    student_result.innerHTML = `<div class="success">Added</div>`;
}

function handleFileSelect() {
    file_name.textContent = csv_file.files[0]?.name || '';
}

async function uploadCSV() {
    const fd = new FormData();
    fd.append('file', csv_file.files[0]);
    await fetch(`${API_URL}/students/bulk`, { method:'POST', body:fd });
    bulk_result.innerHTML = `<div class="success">Uploaded</div>`;
}

function downloadSample() {
    const b = new Blob(["reg_no,student_name,class_id"],{type:'text/csv'});
    const a=document.createElement('a');a.href=URL.createObjectURL(b);a.download='sample.csv';a.click();
}

async function loadStudents() {
    const r = await fetch(`${API_URL}/students`);
    const d = await r.json();
    students_table.innerHTML = `<table class="students-table">${d.map(s=>`<tr><td>${s.reg_no}</td><td>${s.student_name}</td><td>${s.class_id}</td></tr>`).join('')}</table>`;
}

async function loadStats() {
    const s = await (await fetch(`${API_URL}/students`)).json();
    const c = await (await fetch(`${API_URL}/classes`)).json();
    total_students.textContent = s.length;
    total_classes.textContent = c.length;
}

loadClasses();
loadClassesDropdown();
</script>

<!-- GSAP -->
<script src="https://unpkg.com/gsap@3/dist/gsap.min.js"></script>
<script>
gsap.from(".container",{y:30,opacity:0,duration:0.6});

const lightning=document.getElementById("lightning");
window.addEventListener("mousemove",e=>{
    let p=[],x=e.clientX,y=e.clientY;
    for(let i=0;i<8;i++){x+=(Math.random()-0.5)*30;y+=(Math.random()-0.5)*30;p.push(`${x},${y}`);}
    lightning.setAttribute("points",p.join(" "));
    gsap.fromTo(lightning,{opacity:1},{opacity:0,duration:0.35});
});
</script>

</body>
</html>


